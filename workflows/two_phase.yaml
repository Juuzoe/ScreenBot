ddefaults:
  monitor_index: 1                 
  poll_interval_ms: 60
  max_wait_seconds: 30
  dry_run: false

  # Anti-occlusion & anti-left-edge
  hide_cursor_during_grab: true
  neutralize_cursor_if_left_px: 140

  action:
    type: approach_click
    ensure_focus: true
    humanize:
      hover_jitter_ms: 40
      mistake_chance: 0.0
      post_park_away_px: 120
      post_park_safe_margin_px: 80

match_defaults:
  type: template
  confidence: 0.84
  normalize: true
  force_mode: auto
  multiscale:
    enabled: true
    scales: [0.70, 0.78, 0.86, 0.93, 1.00, 1.07, 1.15, 1.23, 1.30]
    pick: best
  auto_dpi_scales: true
  require_green: false
  debug:
    save_on_miss: true
    dir: debug_misses

phase1:
  repeats: 20
  step_min_sec: 0.50
  step_max_sec: 0.55
  cycle_min_sec: 4.0
  cycle_max_sec: 4.4
  steps:
    - name: "P1 Start (robust)"
      pre_wait_ms: 150
      relax_on_timeout: true
      condition:
        type: template
        template_path: "assets/btn_start.png"   # your tower image
        confidence: 0.82
        normalize: true
        force_mode: auto
        multiscale:
          enabled: true
          scales: [0.70, 0.78, 0.86, 0.93, 1.00, 1.07, 1.15, 1.23, 1.30]
          pick: best
        auto_dpi_scales: true
        require_green: false
        debug:
          save_on_miss: true
          dir: "debug_misses"
      action:
        type: approach_click
        click_where: match-center
        ensure_focus: true
        humanize:
          hover_jitter_ms: 40
          post_park_away_px: 140

    - name: P1 Next 1
      condition:
        type: template
        template_path: assets/btn_next1.png
        confidence: 0.9
        multiscale:
          enabled: true
          scales:
          - 0.95
          - 1.0
          - 1.05
          pick: best
      action:
        type: click
        click_where: match-center
    - name: P1 Next 2
      condition:
        type: template
        template_path: assets/btn_next2.png
        confidence: 0.9
        multiscale:
          enabled: true
          scales:
          - 0.95
          - 1.0
          - 1.05
          pick: best
      action:
        type: click
        click_where: match-center
    - name: P1 Next 3
      condition:
        type: template
        template_path: assets/btn_next3.png
        confidence: 0.9
        multiscale:
          enabled: true
          scales:
          - 0.95
          - 1.0
          - 1.05
          pick: best
      action:
        type: click
        click_where: match-center
    - name: P1 Next 4
      condition:
        type: template
        template_path: assets/btn_next4.png
        confidence: 0.9
        multiscale:
          enabled: true
          scales:
          - 0.95
          - 1.0
          - 1.05
          pick: best
      action:
        type: click
        click_where: match-center
    - name: P1 Next 5
      condition:
        type: template
        template_path: assets/btn_next5.png
        confidence: 0.9
        multiscale:
          enabled: true
          scales:
          - 0.95
          - 1.0
          - 1.05
          pick: best
      action:
        type: click
        click_where: match-center
    - name: P1 Next 6
      condition:
        type: template
        template_path: assets/btn_next6.png
        confidence: 0.9
        multiscale:
          enabled: true
          scales:
          - 0.95
          - 1.0
          - 1.05
          pick: best
      action:
        type: click
        click_where: match-center
    - name: P1 Next 7
      condition:
        type: template
        template_path: assets/btn_next7.png
        confidence: 0.9
        multiscale:
          enabled: true
          scales:
          - 0.95
          - 1.0
          - 1.05
          pick: best
      action:
        type: click
        click_where: match-center
phase2:
  repeats: 20
  steps:
  - name: P2 Start
    relax_on_timeout: true
    prepark: band
    condition:
      type: template
      template_path: assets/p2_btn_start.png
      confidence: 0.9
      multiscale:
        enabled: true
        scales:
        - 0.9
        - 0.95
        - 1.0
        - 1.05
        - 1.1
        pick: best
    action:
      type: approach_click
      click_where: match-center
      humanize:
        duration_range:
        - 0.06
        - 0.1
        hover_jitter_px: 1
        hover_jitter_ms: 60
        mistake_chance: 0.002
        approach_band_px:
        - 24
        - 160
        approach_y: near
  - name: P2 Next 1
    condition:
      type: template
      template_path: assets/p2_btn_next1.png
      confidence: 0.9
      multiscale:
        enabled: true
        scales:
        - 0.95
        - 1.0
        - 1.05
        pick: best
    action:
      type: click
      click_where: match-center
  - name: P2 Next 2
    condition:
      type: template
      template_path: assets/p2_btn_next2.png
      confidence: 0.9
      multiscale:
        enabled: true
        scales:
        - 0.95
        - 1.0
        - 1.05
        pick: best
    action:
      type: click
      click_where: match-center
  - name: P2 Next 3
    relax_on_timeout: true
    prepark: band
    condition:
      type: template
      template_path: assets/p2_btn_next3.png
      confidence: 0.9
      multiscale:
        enabled: true
        scales:
        - 0.95
        - 1.0
        - 1.05
        pick: best
    action:
      type: approach_click
      click_where: match-center
      humanize:
        duration_range:
        - 0.06
        - 0.1
        hover_jitter_px: 1
        hover_jitter_ms: 60
        mistake_chance: 0.002
  - name: P2 Next 4
    condition:
      type: template
      template_path: assets/p2_btn_next4.png
      confidence: 0.9
      multiscale:
        enabled: true
        scales:
        - 0.95
        - 1.0
        - 1.05
        pick: best
    action:
      type: click
      click_where: match-center
  - name: P2 Next 6 (right)
    region:
    - 960
    - 0
    - 960
    - 1080
    condition:
      type: template
      template_path: assets/p2_btn_next6.png
      confidence: 0.9
      multiscale:
        enabled: true
        scales:
        - 0.95
        - 1.0
        - 1.05
        pick: best
    action:
      type: click
      click_where: match-center
  - name: P2 Next 7
    condition:
      type: template
      template_path: assets/p2_btn_next7.png
      confidence: 0.9
      multiscale:
        enabled: true
        scales:
        - 0.95
        - 1.0
        - 1.05
        pick: best
    action:
      type: click
      click_where: match-center
  - name: P2 Next 8
    relax_on_timeout: true
    prepark: band
    condition:
      type: template
      template_path: assets/p2_btn_next8.png
      confidence: 0.9
      multiscale:
        enabled: true
        scales:
        - 0.95
        - 1.0
        - 1.05
        pick: best
    action:
      type: approach_click
      click_where: match-center
      humanize:
        duration_range:
        - 0.06
        - 0.1
        hover_jitter_px: 1
        hover_jitter_ms: 60
        mistake_chance: 0.002
  - name: P2 Next 9
    condition:
      type: template
      template_path: assets/p2_btn_next9.png
      confidence: 0.9
      multiscale:
        enabled: true
        scales:
        - 0.95
        - 1.0
        - 1.05
        pick: best
    action:
      type: click
      click_where: match-center
  - name: P2 Next 10
    condition:
      type: template
      template_path: assets/p2_btn_next10.png
      confidence: 0.9
      multiscale:
        enabled: true
        scales:
        - 0.95
        - 1.0
        - 1.05
        pick: best
    action:
      type: click
      click_where: match-center
  - name: P2 Next 11
    condition:
      type: template
      template_path: assets/p2_btn_next11.png
      confidence: 0.9
      multiscale:
        enabled: true
        scales:
        - 0.95
        - 1.0
        - 1.05
        pick: best
    action:
      type: click
      click_where: match-center
  - name: P2 Next 12
    condition:
      type: template
      template_path: assets/p2_btn_next12.png
      confidence: 0.9
      multiscale:
        enabled: true
        scales:
        - 0.95
        - 1.0
        - 1.05
        pick: best
    action:
      type: click
      click_where: match-center
  - name: P2 Next 13
    condition:
      type: template
      template_path: assets/p2_btn_next13.png
      confidence: 0.9
      multiscale:
        enabled: true
        scales:
        - 0.95
        - 1.0
        - 1.05
        pick: best
    action:
      type: click
      click_where: match-center
  - name: P2 Next 14
    condition:
      type: template
      template_path: assets/p2_btn_next14.png
      confidence: 0.9
      multiscale:
        enabled: true
        scales:
        - 0.95
        - 1.0
        - 1.05
        pick: best
    action:
      type: click
      click_where: match-center
  - name: P2 Next 15
    condition:
      type: template
      template_path: assets/p2_btn_next15.png
      confidence: 0.9
      multiscale:
        enabled: true
        scales:
        - 0.95
        - 1.0
        - 1.05
        pick: best
    action:
      type: click
      click_where: match-center
  step_min_sec: 0.45
  step_max_sec: 0.5
  cycle_min_sec: 4.0
  cycle_max_sec: 4.4
